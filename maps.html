<!-- <!DOCTYPE html>
<html>
  <head>
    <title>Google Maps Example</title>
    <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY"></script>
    <script>
      function initMap() {
        var map = new google.maps.Map(document.getElementById("map"), {
          center: { lat: 37.7749, lng: -122.4194 },
          zoom: 10,
        });
      }
    </script>
  </head>
  <body onload="initMap()">
    <div id="map" style="height: 400px; width: 100%;"></div>
  </body>
</html>
 -->

 <!DOCTYPE html>
 <html>
 <head>
     <title>Filtered Google Maps</title>
     <style>
         #map {
             height: 400px;
         }
     </style>
 </head>
 <body>
     <div id="map"></div>
     <div id="ratings"></div>
     <script src="https://maps.googleapis.com/maps/api/js?key="></script>
     <script>
         // Define the waterpoint data as a variable
         var waterpoints = [
             { lat: 37.7749, lng: -122.4194, name: 'Waterpoint 1' },
             { lat: 37.7753, lng: -122.4183, name: 'Waterpoint 2' },
             { lat: 37.7765, lng: -122.4164, name: 'Waterpoint 3' }
         ];
 
         // Initialize the map
         var map = new google.maps.Map(document.getElementById('map'), {
             zoom: 14,
             center: { lat: 37.7749, lng: -122.4194 }
         });
 
         // Get the user's location
         if (navigator.geolocation) {
             navigator.geolocation.getCurrentPosition(function(position) {
                 var userLatLng = { lat: position.coords.latitude, lng: position.coords.longitude };
 
                 // Update the map to center on the user's location
                 map.setCenter(userLatLng);
 
                 // Filter the waterpoints based on distance from the user's location
                 var filteredWaterpoints = waterpoints.filter(function(waterpoint) {
                     var waterpointLatLng = new google.maps.LatLng(waterpoint.lat, waterpoint.lng);
                     var distance = google.maps.geometry.spherical.computeDistanceBetween(userLatLng, waterpointLatLng);
                     return distance < 1000; // Filter waterpoints within 1 km of the user's location
                 });
 
                 // Add markers for the filtered waterpoints and get their ratings
                 var ratingsHTML = '<ul>';
                 for (var i = 0; i < filteredWaterpoints.length; i++) {
                     var marker = new google.maps.Marker({
                         position: { lat: filteredWaterpoints[i].lat, lng: filteredWaterpoints[i].lng },
                         map: map,
                         title: filteredWaterpoints[i].name
                     });
 
                     var request = {
                         placeId: 'ChIJN1t_tDeuEmsRUsoyG83frY4' // Replace with your own Place ID from Google Maps
                     };
                     var service = new google.maps.places.PlacesService(map);
                     service.getDetails(request, function(place, status) {
                         if (status == google.maps.places.PlacesServiceStatus.OK) {
                             ratingsHTML += '<li>' + place.name + ': ' + place.rating + '</li>';
                         }
                         document.getElementById('ratings').innerHTML = ratingsHTML + '</ul>';
                     });
                 }
             });
         } else {
             alert("Geolocation is not supported by this browser.");
         }
     </script>
 </body>
 </html>
 